"0","for (G in X_style_2){
foo2<-foo1 %>%
filter(paste(G, ""=="", 1))%>%
pivot_longer(-c(id, year), names_to=""style"", values_to=""value"") %>%
group_by(year, style) %>%
summarise(n=sum(value))
foo3<-foo2%>% 
  filter(style==G)%>%
select(-style) %>%
rename(G = n)

#library(zoo)

foo4<-foo2 %>% left_join(foo3)%>%

mutate_(paste(""d=n"",G))%>%
rename(d=5) %>%
select(-3,-4) %>%
filter(style !=G) %>% group_by(style)%>%
mutate(p=rollapply(d, 3, mean, fill=0,na.rm=TRUE))

ggplot(foo4, aes(x=year, y=reorder(style, p)))+
geom_tile(aes(fill = p))+
scale_fill_gradient2(low =""skyblue1"", mid = ""seashell"", high = ""deeppink2"", midpoint=.1,limits=c(0,.7), name = ""Probabilit√©"") +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1))+
labs(title = paste(""Un nouvel album de"",G, "" peut aussi √™tre cat√©goris√© comme...""), x=NULL, y=NULL) +
scale_x_continuous(breaks = breaks2)

ggsave(filename=paste0(""./images/style10_"", G , "".jpeg""), plot=last_plot(), width = 27, height = 18, units = ""cm"")

foo5<-foo4%>%
mutate(paste(""target=="",G))
foo<-rbind(foo,foo5)
}
"
"1","[1m[33mError[39m in [38;5;232m`filter()`[39m:[22m
[38;5;232m[33m![38;5;232m Problem while computing `..1 = paste(G, ""=="", 1)`.
[31mx[38;5;232m Input `..1` must be a logical vector, not a character.[39m
Backtrace:
[90m 1. [39m... %>% summarise(n = sum(value))
[90m 6. [39m[38;5;232m[1m[94mdplyr:::filter.data.frame([38;5;232m[22m[39m., paste(G, ""=="", 1)[38;5;232m[1m[94m)[38;5;232m[22m[39m
"
